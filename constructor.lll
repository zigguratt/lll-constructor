;;; ---------------------------------------------------------------------------
;;; @title A constructor parameter test.
;;; @author Daniel Ellison <daniel@syrinx.net>

(seq

  ;; --------------------------------------------------------------------------
  ;; Start initialization.

  (include "macros.lll")

  ;; --------------------------------------------------------------------------
  ;; Compile the contract into `code-body` and record its length.

  (mstore code-length (lll
    (seq

      ;; ----------------------------------------------------------------------
      ;; @notice Returns the constructor parameter.
      ;; @dev Signature: getParameter()

      (when (= function-id get-parameter)
        (seq
          (mstore return-data @@parameter)
          (return return-data 32)))

      ;; ----------------------------------------------------------------------
      ;; @notice Fallback: No functions matched the function ID provided.

      (jump invalid-location))

    code-body))

  ;; --------------------------------------------------------------------------
  ;; Finish initialization.

  ;; Copy the constructor parameters to memory.
  (codecopy temporary program-size 32)

  ;; Move the constructor parameters to storage.
  (sstore parameter @temporary)

  ;; Return the compiled constructor code.
  (return code-body @code-length)

)
